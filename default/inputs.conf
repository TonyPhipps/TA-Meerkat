#[powershell://Meerkat:Get-ADS]
#index = meerkat
#schedule = */5 * * * *
#script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-ADS.psm1"; Get-ADS
#sourcetype = Meerkat:Get-ADS

[powershell://Meerkat:Get-ARP]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-ARP.psm1"; Get-ARP
sourcetype = Meerkat:Get-ARP

[powershell://Meerkat:Get-AuditPolicy]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-AuditPolicy.psm1"; Get-AuditPolicy
sourcetype = Meerkat:Get-AuditPolicy

[powershell://Meerkat:Get-Autoruns]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-Autoruns.psm1"; Get-Autoruns
sourcetype = Meerkat:Get-Autoruns

[powershell://Meerkat:Get-BitLocker]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-BitLocker.psm1"; Get-BitLocker
sourcetype = Meerkat:Get-BitLocker

[powershell://Meerkat:Get-Certificates]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-Certificates.psm1"; Get-Certificates
sourcetype = Meerkat:Get-Certificates

[powershell://Meerkat:Get-RegistryPersistence]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-RegistryPersistence.psm1"; Get-RegistryPersistence
sourcetype = Meerkat:Get-RegistryPersistence

[powershell://Meerkat:Get-ComputerDetails]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-ComputerDetails.psm1"; Get-ComputerDetails
sourcetype = Meerkat:Get-ComputerDetails

[powershell://Meerkat:Get-Defender]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-Defender.psm1"; Get-Defender
sourcetype = Meerkat:Get-Defender

[powershell://Meerkat:Get-Disks]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-Disks.psm1"; Get-Disks
sourcetype = Meerkat:Get-Disks

#[powershell://Meerkat:Get-DLLs]
#index = meerkat
#schedule = */5 * * * *
#script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-DLLs.psm1"; Get-DLLs
#sourcetype = Meerkat:Get-DLLs

[powershell://Meerkat:Get-DNS]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-DNS.psm1"; Get-DNS
sourcetype = Meerkat:Get-DNS

#[powershell://Meerkat:Get-DomainInfo]
#index = meerkat
#schedule = */5 * * * *
#script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-DomainInfo.psm1"; Get-DomainInfo
#sourcetype = Meerkat:Get-DomainInfo

#[powershell://Meerkat:Get-Drivers]
#index = meerkat
#schedule = */5 * * * *
#script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-Drivers.psm1"; Get-Drivers
#sourcetype = Meerkat:Get-Drivers

[powershell://Meerkat:Get-EventLogsMetadata]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-EventLogsMetadata.psm1"; Get-EventLogsMetadata
sourcetype = Meerkat:Get-EventLogsMetadata

[powershell://Meerkat:Get-EnvVars]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-EnvVars.psm1"; Get-EnvVars
sourcetype = Meerkat:Get-EnvVars

[powershell://Meerkat:Get-LocalUsers]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-LocalUsers.psm1"; Get-LocalUsers
sourcetype = Meerkat:Get-LocalUsers

[powershell://Meerkat:Get-LocalGroups]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-LocalGroups.psm1"; Get-LocalGroups
sourcetype = Meerkat:Get-LocalGroups

[powershell://Meerkat:Get-Hardware]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-Hardware.psm1"; Get-Hardware
sourcetype = Meerkat:Get-Hardware

[powershell://Meerkat:Get-Hosts]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-Hosts.psm1"; Get-Hosts
sourcetype = Meerkat:Get-Hosts

[powershell://Meerkat:Get-Hotfixes]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-Hotfixes.psm1"; Get-Hotfixes
sourcetype = Meerkat:Get-Hotfixes

[powershell://Meerkat:Get-EventsLoginFailures]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-EventsLoginFailures.psm1"; Get-EventsLoginFailures
sourcetype = Meerkat:Get-EventsLoginFailures

[powershell://Meerkat:Get-EventsUserManagement]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-EventsUserManagement.psm1"; Get-EventsUserManagement
sourcetype = Meerkat:Get-EventsUserManagement

#[powershell://Meerkat:Get-RegistryMRU]
#index = meerkat
#schedule = */5 * * * *
#script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-EventsUserManagement.psm1"; Get-EventsUserManagement
#sourcetype = Meerkat:Get-EventsUserManagement

[powershell://Meerkat:Get-NetAdapters]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-NetAdapters.psm1"; Get-NetAdapters
sourcetype = Meerkat:Get-NetAdapters

[powershell://Meerkat:Get-NetRoutes]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-NetRoutes.psm1"; Get-NetRoutes
sourcetype = Meerkat:Get-NetRoutes

[powershell://Meerkat:Get-Connections]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-Connections.psm1"; Get-Connections
sourcetype = Meerkat:Get-Connections

[powershell://Meerkat:Get-Registry]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-Registry.psm1"; Get-Registry
sourcetype = Meerkat:Get-Registry

[powershell://Meerkat:Get-ScheduledTasks]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-ScheduledTasks.psm1"; Get-ScheduledTasks
sourcetype = Meerkat:Get-ScheduledTasks

[powershell://Meerkat:Get-Services]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-Services.psm1"; Get-Services
sourcetype = Meerkat:Get-Services

#[powershell://Meerkat:Get-Sessions]
#index = meerkat
#schedule = */5 * * * *
#script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-Sessions.psm1"; Get-Sessions
#sourcetype = Meerkat:Get-Sessions

[powershell://Meerkat:Get-Shares]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-Shares.psm1"; Get-Shares
sourcetype = Meerkat:Get-Shares

[powershell://Meerkat:Get-Software]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-Software.psm1"; Get-Software
sourcetype = Meerkat:Get-Software

#[powershell://Meerkat:Get-Strings]
#index = meerkat
#schedule = */5 * * * *
#script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-Strings.psm1"; Get-Strings
#sourcetype = Meerkat:Get-Strings

[powershell://Meerkat:Get-TPMDetails]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-TPMDetails.psm1"; Get-TPMDetails
sourcetype = Meerkat:Get-TPMDetails

#[powershell://Meerkat:Get-MAC]
#index = meerkat
#schedule = */5 * * * *
#script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-MAC.psm1"; Get-MAC
#sourcetype = Meerkat:Get-MAC

[powershell://Meerkat:Get-Processes]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-Processes.psm1"; Get-Processes
sourcetype = Meerkat:Get-Processes

#[powershell://Meerkat:Get-RecycleBin]
#index = meerkat
#schedule = */5 * * * *
#script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-RecycleBin.psm1"; Get-RecycleBin
#sourcetype = Meerkat:Get-RecycleBin

#[powershell://Meerkat:Get-EventLogs]
#index = meerkat
#schedule = */5 * * * *
#script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-EventLogs.psm1"; Get-EventLogs
#sourcetype = Meerkat:Get-EventLogs

[powershell://Meerkat:Get-USBHistory]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-USBHistory.psm1"; Get-USBHistory
sourcetype = Meerkat:Get-USBHistory

[powershell://Meerkat:Get-WindowsFirewall]
index = meerkat
schedule = */5 * * * *
script = Import-Module "$SplunkHome\etc\apps\TA-Meerkat\bin\Modules\Get-WindowsFirewall.psm1"; Get-WindowsFirewall
sourcetype = Meerkat:Get-WindowsFirewall

#-----------------------------------------------------
# Alternative approach for monitoring output csv files
#-----------------------------------------------------
[monitor://c:\artifacts\meerkat]
disabled = 0
meerkatursive = true
crcSalt = <SOURCE>
sourcetype = Meerkat:Output:CSV
host_regex = [\/\\](\w+)_[^\.]+\.csv$

[monitor://c:\artifacts\meerkat\*\*.csv]
disabled = 0
meerkatursive = true
crcSalt = <SOURCE>
sourcetype = Meerkat:Output:CSV
host_regex = [\/\\](\w+)_[^\.]+\.csv$

[monitor://c:\artifacts\meerkat\*\*\*.csv]
disabled = 0
meerkatursive = true
crcSalt = <SOURCE>
sourcetype = Meerkat:Output:CSV
host_regex = [\/\\](\w+)_[^\.]+\.csv$

[monitor:///mnt/artifacts/meerkat]
disabled = 0
meerkatursive = true
crcSalt = <SOURCE>
sourcetype = Meerkat:Output:CSV
host_regex = [\/\\](\w+)_[^\.]+\.csv$

[monitor:///mnt/artifacts/meerkat/.../*.csv]
disabled = 0
meerkatursive = true
crcSalt = <SOURCE>
sourcetype = Meerkat:Output:CSV
host_regex = [\/\\](\w+)_[^\.]+\.csv$

[monitor:///mnt/artifacts/meerkat/.../.../*.csv]
disabled = 0
meerkatursive = true
crcSalt = <SOURCE>
sourcetype = Meerkat:Output:CSV
host_regex = [\/\\](\w+)_[^\.]+\.csv$
